var app=angular.module("template",["ngNewRouter","ui.bootstrap","ngMessages","snap"]),MenuController=function(){function t(t){this.isActive=function(t){return t===this.location.path()||""===this.location.path()&&"/"===t?!0:void 0},this.location=t}return t.$inject=["$location"],t}();app.controller("MenuController",MenuController);var RESTService=function(){function t(t,e){this.http=t,this.q=e,this.baseUrl="case1/"}return t.prototype.callServer=function(t,e,o,r){var s=this.q.defer();switch(t){case"get":this.http.get(this.baseUrl+e).then(function(t){return s.resolve(t.data)})["catch"](function(t){return s.reject("server error")});break;case"post":this.http.post(this.baseUrl+e,r).then(function(t){return s.resolve(t.data)})["catch"](function(t){return s.reject("server error")});break;case"put":this.http.put(this.baseUrl+e,r).then(function(t){return s.resolve(t.data)})["catch"](function(t){return s.reject("server error")});break;case"delete":this.http["delete"](this.baseUrl+e+"/"+o).then(function(t){return s.resolve(t.data)})["catch"](function(t){return s.reject("server error")})}return s.promise},t.$inject=["$http","$q"],t}();app.service("RESTService",RESTService);var RoutesController=function(){function t(t){this.$router=t,t.config([{path:"/",redirectTo:"/home"},{path:"/home",component:"home"},{path:"/vendor",component:"vendor"},{path:"/product",component:"product"},{path:"/generator",component:"generator"}])}return t.$inject=["$router"],t}();app.controller("RoutesController",RoutesController);var GeneratorController=function(){function t(t,e){this.restsvc=t,this.windowsvc=e,this.loadProducts(),this.loadVendors(),this.pickedVendor=!1,this.isAddClick=!1,this.status="Choose a Vendor",this.isPOClick=!1}return t.prototype.loadProducts=function(t){var e=this;return this.restsvc.callServer("get","product").then(function(t){e.products=t})["catch"](function(t){return e.status="Products not retrieved code - "+t})},t.prototype.loadVendors=function(){var t=this;return this.restsvc.callServer("get","vendor").then(function(e){t.vendors=e})["catch"](function(e){return t.status="Vendors not retrieved code - "+e})},t.prototype.setPrices=function(t,e){1==e?this.sub=(parseFloat(this.sub)-t).toFixed(2):this.sub=(parseFloat(this.sub)+t).toFixed(2),0==t&&(this.sub="0",this.isAddClick=!1),this.tax=(Math.round(.13*parseFloat(this.sub)*100)/100).toFixed(2),this.total=(Math.round(100*(parseFloat(this.sub)+parseFloat(this.tax)))/100).toFixed(2)},t.prototype.addItem=function(){this.isPOClick=!1;var t;if(t="EOQ"==this.quantity?this.product.EOQ:parseInt(this.quantity),0!=t){this.isAddClick=!0,this.setPrices(this.product.costPrice*t,!1);for(var e=!1,o=0;o<this.genItems.length;o++)if(this.product.productName==this.genItems[o].productname){this.genItems[o].qty+=t,this.genItems[o].ext+=this.product.costPrice*t,e=!0;break}0==e&&this.genItems.push({prodcd:this.product.productCode,productname:this.product.productName,ext:this.product.costPrice*t,price:this.product.costPrice,qty:t}),this.status="item Added"}else{for(var o=0;o<this.genItems.length;o++)if(this.product.productName==this.genItems[o].productname){this.setPrices(this.genItems[o].ext,!0),this.genItems.splice(o,1),this.status="item Removed";break}0==this.genItems.length&&(this.setPrices(0,!0),this.status="no items")}},t.prototype.selectVen=function(t){var e=this;return null!=t&&(this.pickedVendor=!0,this.status="Products Retrieved",this.genItems=[],this.setPrices(0,!0)),void this.restsvc.callServer("get","product/"+t).then(function(t){e.products=t})["catch"](function(t){return e.status="Products not retrieved code - "+t})},t.prototype.createPO=function(){var t=this;this.isPOClick=!0,this.status="Wait...";var e={vendorNo:this.vendor.vendorNo,ponumber:"0",items:this.genItems,total:parseFloat(this.total),date:void 0};return this.restsvc.callServer("post","purchaseorder","",e).then(function(e){e>0?(t.status="PO "+e+" Created!",t.pono=e,t.generated=!0):t.status="Problem generating PO, contact purchaing"}).then(this.selectVen(this.vendor.vendorNo))["catch"](function(e){return t.status="PO not created - "+e})},t.prototype.viewPdf=function(){this.isPOClick=!1,this.windowsvc.location.href="http://localhost:8080/APPOCase1/PDFSample?po="+this.pono},t.$inject=["RESTService","$window"],t}();app.controller("GeneratorController",GeneratorController);var VendorController=function(){function t(t,e,o){this.restsvc=t,this.modal=e,this.filter=o,this.loadVendors()}return t.prototype.loadVendors=function(t){var e=this;return this.restsvc.callServer("get","vendor").then(function(o){e.vendors=o,t?e.status=t+" - Vendors Retrieved":e.status="Vendors Retrieved"})["catch"](function(t){return e.status="Vendors not retrieved code - "+t})},t.prototype.selectRow=function(t,e){var o=this;this.selectedRow=t,this.vendor=e;var r={templateUrl:"components/vendor/vendorModal.html",controller:VendorModalController.Id+" as ctrlr",resolve:{modalData:function(){return e}}};this.modal.open(r).result.then(function(t){return o.processModal(t)})["catch"](function(t){return o.status=t})},t.prototype.processModal=function(t){var e=this,o="";switch(t.operation){case"update":return this.restsvc.callServer("put","vendor",t.vendor.vendorNo,t.vendor).then(function(r){1===parseInt(r,10)&&(o="Vendor "+t.vendor.vendorNo+" Updated! ",e.loadVendors(o))})["catch"](function(t){return e.status="Vendor Not Updated! - "+t});case"cancel":this.loadVendors(t.status),this.selectedRow=-1;break;case"delete":return this.restsvc.callServer("delete","vendor",t.vendor.vendorNo,t.vendor).then(function(r){1===parseInt(r,10)&&(o="Vendor "+t.vendor.vendorNo+" Deleted! ",e.loadVendors(o))})["catch"](function(t){return e.status="Vendor Not Deleted! - "+t});case"add":return this.restsvc.callServer("post","vendor",void 0,t.vendor).then(function(t){o="Vendor "+t+" Added! ",e.loadVendors(o)})["catch"](function(t){return e.status="Vendor Not Added! - "+t})}this.status=t},t.prototype.findSelected=function(t,e){if(this.vendors=this.filter("orderBy")(this.vendors,t,e),this.vendor)for(var o=0;o<this.vendors.length;o++)this.vendors[o].vendorNo===this.vendor.vendorNo&&(this.selectedRow=o)},t.$inject=["RESTService","$modal","$filter"],t}();app.controller("VendorController",VendorController);var VendorModalController=function(){function t(t,e){this.modal=t,this.vendor=e,this.vendor=e,e?(this.modalTitle="Update Details for Vendor "+e.vendorNo,this.todo="update"):(this.modalTitle="Add Details for New Vendor ",this.todo="add"),this.retVal={operation:"",retVendor:e,status:""}}return t.prototype.add=function(){this.retVal.operation="add",this.retVal.vendor=this.vendor,this.modal.close(this.retVal)},t.prototype.cancel=function(){this.retVal.operation="cancel",this.vendor?this.retVal.status=this.vendor.name+" not changed!":this.retVal.status="No Vendor Entered",this.modal.close(this.retVal)},t.prototype.update=function(){this.retVal.operation="update",this.retVal.vendor=this.vendor,this.modal.close(this.retVal)},t.prototype["delete"]=function(){this.retVal.operation="delete",this.retVal.vendor=this.vendor,this.modal.close(this.retVal)},t.$inject=["$modalInstance","modalData"],t.Id="VendorModalController",t}();app.controller("VendorModalController",VendorModalController);var ProductController=function(){function t(t,e,o){this.restsvc=t,this.modal=e,this.filter=o,this.loadProducts(),this.loadVendors()}return t.prototype.loadProducts=function(t){var e=this;return this.restsvc.callServer("get","product").then(function(o){e.products=o,t?e.status=t+" - Products Retrieved":e.status="Products Retrieved"})["catch"](function(t){return e.status="Products not retrieved code - "+t})},t.prototype.loadVendors=function(){var t=this;return this.restsvc.callServer("get","vendor").then(function(e){t.vendors=e})["catch"](function(e){return t.status="Vendors not retrieved code - "+e})},t.prototype.selectRow=function(t,e){var o=this;this.selectedRow=t,this.product=e;var r={prod:e,vens:this.vendors},s={templateUrl:"components/product/productModal.html",controller:ProductModalController.Id+" as ctrlr",resolve:{modalData:function(){return r}}};this.modal.open(s).result.then(function(t){return o.processModal(t)})["catch"](function(t){return o.status=t})},t.prototype.processModal=function(t){var e=this,o="";switch(t.operation){case"update":return this.restsvc.callServer("put","product",t.product.productCode,t.product).then(function(r){1===parseInt(r,10)&&(o="Product "+t.product.productCode+" Updated! ",e.loadProducts(o))})["catch"](function(t){return e.status="Product Not Updated! - "+t});case"cancel":this.loadProducts(t.status),this.selectedRow=-1;break;case"delete":return this.restsvc.callServer("delete","product",t.product.productCode,t.product).then(function(r){1===parseInt(r,10)&&(o="Product "+t.product.productcode+" Deleted! ",e.loadProducts(o))})["catch"](function(t){return e.status="Product Not Deleted! - "+t});case"add":return this.restsvc.callServer("post","product",void 0,t.product).then(function(t){o="Product "+t+" Added! ",e.loadProducts(o)})["catch"](function(t){return e.status="Product Not Added! - "+t})}this.status=t},t.prototype.findSelected=function(t,e){if(this.products=this.filter("orderBy")(this.products,t,e),this.product)for(var o=0;o<this.products.length;o++)this.products[o].productCode===this.product.productCode&&(this.selectedRow=o)},t.$inject=["RESTService","$modal","$filter"],t}();app.controller("ProductController",ProductController);var ProductModalController=function(){function t(t,e){this.modal=t,this.product=e.prod,this.vendors=e.vens,this.product?(this.modalTitle="Update Details for Product "+this.product.productCode,this.todo="update"):(this.modalTitle="Add Details for New Product ",this.todo="add"),this.retVal={operation:"",retProduct:this.product,status:""}}return t.prototype.add=function(){this.retVal.operation="add",this.retVal.product=this.product,this.modal.close(this.retVal)},t.prototype.cancel=function(){this.retVal.operation="cancel",this.product?this.retVal.status=this.product.productName+" not changed!":this.retVal.status="No Product Entered",this.modal.close(this.retVal)},t.prototype.update=function(){this.retVal.operation="update",this.retVal.product=this.product,this.modal.close(this.retVal)},t.prototype["delete"]=function(){this.retVal.operation="delete",this.retVal.product=this.product,this.modal.close(this.retVal)},t.$inject=["$modalInstance","modalData"],t.Id="ProductModalController",t}();app.controller("ProductModalController",ProductModalController);var HomeController=function(){function t(){this.label="Byron"}return t}();app.controller("HomeController",[HomeController]);